<!DOCTYPE html>
<html lang="en"     prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml" >

<head>
    <title>Hasty Impressions: OpenCover - Blair Conrad</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://blairconrad.com/2011/08/15/hasty-impressions-opencover/">

        <meta name="author" content="Blair Conrad" />
        <meta name="keywords" content=".NET,coverage,OpenCover,HastyImpressions,Isolator,Testing,TypeMock" />
        <meta name="description" content="OpenCover is developed by Shaun Wilde. He was a developer on (and is the only remaining maintainer of) PartCover. He&#39;s used what he learned working on PartCover to develop OpenCover, but OpenCover is a new implementation, not a port. I tried OpenCover 1.0.514. Since I downloaded a couple …" />

        <meta property="og:site_name" content="Blair Conrad" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Hasty Impressions: OpenCover"/>
        <meta property="og:url" content="https://blairconrad.com/2011/08/15/hasty-impressions-opencover/"/>
        <meta property="og:description" content="OpenCover is developed by Shaun Wilde. He was a developer on (and is the only remaining maintainer of) PartCover. He&#39;s used what he learned working on PartCover to develop OpenCover, but OpenCover is a new implementation, not a port. I tried OpenCover 1.0.514. Since I downloaded a couple …"/>
        <meta property="article:published_time" content="2011-08-15" />
            <meta property="article:section" content="Development" />
            <meta property="article:tag" content=".NET" />
            <meta property="article:tag" content="coverage" />
            <meta property="article:tag" content="OpenCover" />
            <meta property="article:tag" content="HastyImpressions" />
            <meta property="article:tag" content="Isolator" />
            <meta property="article:tag" content="Testing" />
            <meta property="article:tag" content="TypeMock" />
            <meta property="article:author" content="Blair Conrad" />



    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://blairconrad.com/theme/css/bootstrap.min.css" type="text/css" />

    <link href="https://blairconrad.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blairconrad.com/theme/css/pygments/github.css"
        rel="stylesheet">
    <link href="https://blairconrad.com/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blairconrad.com/theme/css/style.css" type="text/css" />
    <link href="https://blairconrad.com/theme/css/custom.css" rel="stylesheet">

    <link href="https://blairconrad.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
        title="Blair Conrad ATOM Feed" />

    <link href="https://blairconrad.com/feeds/development.atom.xml" type="application/atom+xml" rel="alternate"
        title="Blair Conrad Development ATOM Feed" />
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top"
        role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="https://blairconrad.com/" class="navbar-brand">
Blair Conrad                </a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/Recipes">Recipes</a></li>
                        <li class="active" >
                            <a href="https://blairconrad.com/category/development.html">Development</a>
                        </li>
                        <li >
                            <a href="https://blairconrad.com/category/miscellany.html">Miscellany</a>
                        </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><span>
                            <form class="navbar-search" action="/search.html">
                                <input type="text" class="search-query" placeholder="Search" name="q"
                                    id="tipue_search_input" required>
                            </form>
                        </span>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </div> <!-- /.navbar -->

    <!-- Banner -->
    <!-- End Banner -->

    <!-- Content Container -->
    <div class="container">
        <div class="row">
            <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://blairconrad.com/2011/08/15/hasty-impressions-opencover/"
                       rel="bookmark"
                       title="Permalink to Hasty Impressions: OpenCover">
                        Hasty Impressions&#58; OpenCover
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <!-- <span class="published"> -->
    <i class="fa fa-calendar"></i><time datetime="2011-08-15T00:00:00-04:00"> 2011-08-15</time>
    <!-- </span> -->

    <i class="fa fa-list"></i>
    Part 4 of .NET Coverage Tools


    <i class="fa fa-folder"></i>
    <a href="https://blairconrad.com/category/development.html"></i>Development</a>


<i class="fa fa-tags"></i>
<a href="https://blairconrad.com/tag/.net.html">.NET</a>
/
<a href="https://blairconrad.com/tag/coverage.html">coverage</a>
/
<a href="https://blairconrad.com/tag/opencover.html">OpenCover</a>
/
<a href="https://blairconrad.com/tag/hastyimpressions.html">HastyImpressions</a>
/
<a href="https://blairconrad.com/tag/isolator.html">Isolator</a>
/
<a href="https://blairconrad.com/tag/testing.html">Testing</a>
/
<a href="https://blairconrad.com/tag/typemock.html">TypeMock</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><a href="https://github.com/sawilde/opencover">OpenCover</a> is developed by Shaun Wilde. He was a developer on (and is the only remaining maintainer of) PartCover. He's used what he learned working on PartCover to develop OpenCover, but OpenCover is a new implementation, not a port.</p>
<p>I tried OpenCover 1.0.514. Since I downloaded a couple weeks ago there have been 3 more releases, with the 1.0.606 release promising a big performance improvement.
<h2>The Cost</h2>
Free! And you can get the source.
<h2>VS integration</h2>
None that I can find.
<h2>Command Line Execution</h2>
Covering an application from the command line is <strong>easy</strong>, and reminiscent of using PartCover the same way. I used this command to see what code my BookFinder unit tests exercised:</p>
<pre><code class="bat">OpenCover.Console.exe -arch:64 -register target:nunit-console.exe -targetargs:bin\debug\BookFinder.Tests.dll \
                      -output:..\..\opencover.xml -filter:+[BookFinder.Core]*</code></pre>

<!--more-->

<p>Let's look at that.</p>
<ul>
<li><code>-arch:64</code> - I'm running on a 64-bit system. I didn't get any results without this.</li>
<li><code>-register</code> - I'm auto-deploying OpenCover. More on that later.</li>
<li><code>-target:nunit-console.exe</code> - I like NUnit</li>
<li><code>-targetargs:bin\debug\BookFinder.Tests.dll</code> - arguments to NUnit to tell it what assembly to test, and how.</li>
<li><code>-output:..\..\opencover.xml</code> - where to put the coverage results. This file is not a report - it's intended for machines to read, not humans.</li>
<li><code>-filter:+[BookFinder.Core]*</code> - BookFinder.Core is the only assembly I was interested in - it holds the business logic.</li>
</ul>
<h2>GUI Runner</h2>

<p>There isn't one, but I have to wonder if there won't be. Otherwise, why call the command line coverer <strong>OpenCover.Console.exe</strong>?</p>
<h2>XML Report</h2>

<p>OpenCover doesn't generate a human-readable report. Instead, you can postprocess the coverage output. <b><a href="http://www.palmmedia.de/Net/ReportGenerator">ReportGenerator</a> is the recommended tool</b>, and it works like a charm.</p>
<pre><code class="bat">ReportGenerator.exe .\opencover.xml XmlReport Xml</code></pre>

<p>generates an XML report in the <code>Xml</code> directory. The summary looks like this:</p>
<pre><code class="xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;CoverageReport scope="Summary"&gt;
  &lt;Summary&gt;
    &lt;Generatedon&gt;2011-08-05-2011-08-05&lt;/Generatedon&gt;
    &lt;Parser&gt;OpenCoverParser&lt;/Parser&gt;
    &lt;Assemblies&gt;1&lt;/Assemblies&gt;
    &lt;Files&gt;5&lt;/Files&gt;
    &lt;Coverage&gt;71.6%&lt;/Coverage&gt;
    &lt;Coveredlines&gt;126&lt;/Coveredlines&gt;
    &lt;Coverablelines&gt;176&lt;/Coverablelines&gt;
    &lt;Totallines&gt;495&lt;/Totallines&gt;
  &lt;/Summary&gt;
  &lt;Assemblies&gt;
    &lt;Assembly name="BookFinder.Core.DLL" coverage="71.6"&gt;
      &lt;Class name="BookFinder.BookDepository" coverage="85.7" /&gt;
      &lt;Class name="BookFinder.BookListViewModel" coverage="50" /&gt;
      &lt;Class name="BookFinder.BoolProperty" coverage="50" /&gt;
      &lt;Class name="BookFinder.BoundPropertyStrategy" coverage="0" /&gt;
      &lt;Class name="BookFinder.ListProperty" coverage="75" /&gt;
      &lt;Class name="BookFinder.Property" coverage="100" /&gt;
      &lt;Class name="BookFinder.StringProperty" coverage="100" /&gt;
      &lt;Class name="BookFinder.ViewModelBase" coverage="81" /&gt;
    &lt;/Assembly&gt;
  &lt;/Assemblies&gt;
&lt;/CoverageReport&gt;</code></pre>

<p>ReportGenerator also generates Html and LaTeX output, with a "summary" variant for each of the three output types.</p>
<p>The XML report would be most useful for inclusion in build result reports, but I found the HTML version easy to use to examine coverage results down to the method level.</p>
<div class="images">
<a href="https://blairconrad.com/images/html_summary.png"><img title="html_summary" align="top" src="https://blairconrad.com/images/html_summary.png?w=270" alt="HTML Coverage Summary" width="270" height="300" /></a>&nbsp;<a href="https://blairconrad.com/images/html_detail.png"><img title="html_detail" align="top" src="https://blairconrad.com/images/html_detail.png?w=300" alt="HTML Coverage Detail" width="300" height="208" /></a>
</div>

<p>I appreciate the coverage count by each of the lines - not as fancy as dotCover's "which tests cover this", but it could be a helpful clue when you're trying to decide what you need to do to improve your coverage.</p>
<h2>Joining Coverage Runs</h2>

<p>Perhaps your test are scattered in space or time and you want to get an overview of all the code that's covered by them. OpenCover doesn't really do anything special for you, but <strong>ReportGenerator has your back</strong>. Specify multiple input files on the command line, and the results will be aggregated and added to a comprehensive report:</p>
<pre><code class="bat">ReportGenerator.exe output1.xml;output2.xml;output3.xml XmlReport Xml</code></pre>

<h2>DIY Auto-Deploy</h2>

<p>There's no built-in auto-deploy for OpenCover. However, <b>I made my own auto-deployable package</b> like so:
<ol>
<li>install OpenCover</li>
<li>copy the <code>C:\Program Files (x86)\OpenCover</code> directory somewhere - call this your <i>package directory</i></li>
<li>uninstall OpenCover - you won't need it any more</li>
</ol></p>
<p>Then I just made sure my coverage build step 
<ul>
<li>knew where the OpenCover package directory was (for the build system at the Day Job, I added it to our "subscribes")</li>
<li>used the <code>-register</code> flag mentioned above to register OpenCover before running the tests</li>
</ul>
That's it. No muss, no fuss. I did a similar (but easier, since there's no registration needed) trick with ReportGenerator, and all of a sudden I have a no-deploy system.</p>
<p>In less than an hour's work, I could upgrade a project so the build servers and all the developers could run a coverage target, with no action on their part, other than pulling the updated source tree and building. (Which is pretty much what the build server does all day long anyhow...)</p>
<h2>DIY (for now) Coverage with Isoloator</h2>

<p>Isoloator and OpenCover don't work together out of the box, but thanks to advice I got from <a href="http://www.hmemcpy.com/blog/">Igal Tabachnik</a>, Typemock employee, it was not hard to change this.</p>
<p>Isolator's supported coverage tools are partly configurable. There is a <code>typemockconfig.xml</code> under the Isolator install directory - typically <code>%ProgramFiles (x86)%\Typemock\Isoloator\6.0</code> (or <code>%ProgramFiles%</code>, I suppose). Mr. Tabachnik had me add
<pre><code class="xml">&lt;Profiler Name="OpenCover" Clsid="{1542C21D-80C3-45E6-A56C-A9C1E4BEB7B8}" DirectLaunch="false"&gt;
  &lt;EnvironmentList /&gt;
&lt;/Profiler&gt;</code></pre>
to the <code>ProfilerList</code> element, and everything meshed. His <a href="http://stackoverflow.com/questions/6698290/can-opencover-be-used-with-typemock-isolator">StackOverflow answer</a> provides full details and suggests that official support for OpenCover will be added to Isolator. </p>
<h2>IIS</h2>

<p>I can't find any special IIS support. I'm not saying OpenCover can't be used to cover an application running in IIS, only that I didn't find any help for it. I may investigate this later.</p>
<h2>Sequence Point coverage</h2>

<p>OpenCover counts sequence points, not statements. Yay!</p>
<h2>Conclusion</h2>

<p><strong>Pros:</strong>
<ul>
    <li>free</li>
        <li>open source</li>
        <li>active project</li>
    <li>XML/HTML/LaTeX reports (via ReportGenerator)</li>
    <li>report merging (via ReportGenerator)</li>
    <li>Isolator support is easy to add (and may be included in future Isolators)</li>
        <li>auto-deploy package is easy to make</li>
</ul>
<strong>Cons:</strong>
<ul>
    <li>no IDE integration</li>
    <li>no help with IIS profiling</li>
</ul></p>
<p>I really like OpenCover. It's easy to use, relatively full-featured, and free. In a work environment, where there's a tonne of developers who want the in-IDE profiling experience, it may not be the best bet, but I'd use it for my personal .NET projects in a flash. </p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Part 4 of the .NET Coverage Tools series</h4>
       <h5>Previous articles</h5>
       <ul>
           <li><a href="https://blairconrad.com/2011/07/18/can-you-cover-me-looking-for-a-.net-coverage-tool/">Can you cover me&#63; Looking for a .NET coverage tool</a></li>
           <li><a href="https://blairconrad.com/2011/07/29/hasty-impressions-dotcover-1.1/">Hasty Impressions&#58; dotCover 1.1</a></li>
           <li><a href="https://blairconrad.com/2011/08/05/hasty-impressions-partcover/">Hasty Impressions&#58; PartCover</a></li>
       </ul>
       <h5>Next articles</h5>
       <ul>
           <li><a href="https://blairconrad.com/2011/11/09/hasty-impressions-ncover/">Hasty Impressions&#58; NCover</a></li>
           <li><a href="https://blairconrad.com/2011/12/15/best-all-around-.net-coverage-tool-opencover/">Best all-around .NET coverage tool - OpenCover</a></li>
       </ul>
</section>
        </article>
    </section>

            </div>
            <div class="col-sm-3" id="sidebar">
                <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="http://github.com/blairconrad"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
    <li class="list-group-item"><a href="http://twitter.com/hippopottoman"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
    <li class="list-group-item"><a href="https://www.goodreads.com/user/show/1066544-blair-conrad"><i class="fa fa-goodreads-square fa-lg"></i> Goodreads</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Series -->
<li class="list-group-item">
  <h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Series</span></h4>
  <ul class="list-group">
    <li class="list-group-item">
      <h5></i>Previous article</h5>
      <a href="https://blairconrad.com/2011/08/05/hasty-impressions-partcover/">Hasty Impressions&#58; PartCover</a>
    </li>
    <li class="list-group-item">
      <h5>Next article</h5>
      <a href="https://blairconrad.com/2011/11/09/hasty-impressions-ncover/">Hasty Impressions&#58; NCover</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Series -->

  </ul>
</section>
<!-- End Sidebar -->                </aside>
            </div>
        </div>
    </div>
    <!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Blair Conrad
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
    <script src="https://blairconrad.com/theme/js/jquery.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://blairconrad.com/theme/js/bootstrap.min.js"></script>

    <!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
    <script src="https://blairconrad.com/theme/js/respond.min.js"></script>




</body>

</html>