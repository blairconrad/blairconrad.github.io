<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Quickly make editable diagrams with yUML - Blair Conrad</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://blairconrad.com/2010/05/01/quickly-make-editable-diagrams-with-yuml/">

        <meta name="author" content="Blair Conrad" />
        <meta name="keywords" content="Development,PNG,yUML" />
        <meta name="description" content="I&#39;m always on the lookout for convenient tools for creating diagrams that can be used for software development. Balsamiq is my tool of choice for UI mockups - it&#39;s great for whipping up stylized interfaces in very little time. Balsamiq does a great job of simplifying mockup creation, since it takes …" />

        <meta property="og:site_name" content="Blair Conrad" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Quickly make editable diagrams with yUML"/>
        <meta property="og:url" content="https://blairconrad.com/2010/05/01/quickly-make-editable-diagrams-with-yuml/"/>
        <meta property="og:description" content="I&#39;m always on the lookout for convenient tools for creating diagrams that can be used for software development. Balsamiq is my tool of choice for UI mockups - it&#39;s great for whipping up stylized interfaces in very little time. Balsamiq does a great job of simplifying mockup creation, since it takes …"/>
        <meta property="article:published_time" content="2010-05-01" />
            <meta property="article:section" content="Development" />
            <meta property="article:tag" content="Development" />
            <meta property="article:tag" content="PNG" />
            <meta property="article:tag" content="yUML" />
            <meta property="article:author" content="Blair Conrad" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blairconrad.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://blairconrad.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blairconrad.com/theme/css/pygments/github.css" rel="stylesheet">
    <link href="https://blairconrad.com/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blairconrad.com/theme/css/style.css" type="text/css"/>
        <link href="https://blairconrad.com/theme/css/custom.css" rel="stylesheet">

        <link href="https://blairconrad.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Blair Conrad ATOM Feed"/>

        <link href="https://blairconrad.com/feeds/development.atom.xml" type="application/atom+xml" rel="alternate"
              title="Blair Conrad Development ATOM Feed"/>
</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blairconrad.com/" class="navbar-brand">
Blair Conrad            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/Recipes">Recipes</a></li>
                        <li class="active">
                            <a href="https://blairconrad.com/category/development.html">Development</a>
                        </li>
                        <li >
                            <a href="https://blairconrad.com/category/miscellany.html">Miscellany</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://blairconrad.com/2010/05/01/quickly-make-editable-diagrams-with-yuml/"
                       rel="bookmark"
                       title="Permalink to Quickly make editable diagrams with yUML">
                        Quickly make editable diagrams with yUML
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span><i class="fa fa-calendar"></i><time datetime="2010-05-01T00:00:00-04:00">2010-05-01</time></span>
    <span><i class="fa fa-folder"></i><a href="https://blairconrad.com/category/development.html"></i>Development</a></span>


<span><i class="fa fa-tags"></i>
<a href="https://blairconrad.com/tag/development.html">Development</a>
/
<a href="https://blairconrad.com/tag/png.html">PNG</a>
/
<a href="https://blairconrad.com/tag/yuml.html">yUML</a>
</span>
    

</footer><!-- /.post-info -->                    </div>
                </div>
                <p>I'm always on the lookout for convenient tools for creating diagrams that can be used for software development. <a href="http://www.balsamiq.com/">Balsamiq</a> is my tool of choice for UI mockups - it's great for whipping up stylized interfaces in very little time.</p>
<p>Balsamiq does a great job of simplifying mockup creation, since it takes a lot of choices away from the user - you don't have the ability to change fonts or line thicknesses or colours. It really lets you focus on the aspects of the interface that matter when you're just getting started - the types and relative positions of the screen elements.</p>
<p>Recently I discovered <a href="http://yuml.me/">yUML</a> - an online tool for creating class diagrams, activity diagrams, and use case diagrams. It's quite simple and produces attractive results. The best part is that you just specify the relationship between components - you don't have to position them yourself.</p>
<p>Using an example from the site, you can create a diagram that shows that:
<ul>
    <li>a single customer aggregates several orders,each of which</li>
    <li>uses 0 or 1 PaymentMethods, and</li>
    <li>is composed of some number of LineItems</li>
</ul>
by entering this code:</p>
<pre>
[Customer]+1-&gt;*[Order]
[Order]++1-items &gt;*[LineItem]
[Order]-0..1&gt;[PaymentMethod]
</pre>

<p>And out pops this diagram:</p>
<div class="images">
  <img class="aligncenter size-full wp-image-414" title="yUML Order Example" src="https://blairconrad.com/images/yuml_order_example.png" alt="yUML Order Class Diagram" width="605" height="152" />
</div>

<p>Over the years, I've become accustomed to using WYSIWYG tools to create written documents and images, but I often miss text-based tools. They:
<ul>
    <li>give consistent, repeatable results,</li>
    <li>allow easy diffing between versions, and</li>
    <li>don't encourage time-wasting as we fiddle to adjust every single pixel or line break</li>
</ul>
so I was really happy to find yUML - even though the syntax takes a little getting used to, it makes it easy to generate diagrams with a minimum of fuss.</p>
<p>One wrinkle I've had using tools like Balsamiq and yUML is going back to modify diagrams after I've saved them off as a PNG. The last time I posted a Balsamiq PNG, I resorted to <a href="https://blairconrad.com/2010/02/07/using-subversion-to-evangelize-powershell/#getting_started">embedding the text that represented the diagram in the post comments</a>. Actually, don't bother clicking that link - I'm sure I had the source saved in the post as an HTML comment, but I don't see it there, not even in edit mode.</p>
<p>I've unwittingly demonstrated a point I was trying to make - many of these design tools don't allow you to save the "source" of the diagram, and it could be lost. This isn't a disaster for simple diagrams like the one above, but it could be very inconvenient for larger ones. Another problem is that typing out the code, pasting it into the conversion tool (in yUML's case a web page), and converting it and saving the result can become tedious as you make many adjustments.</p>
<p>To address some of these inconveniences, I created a tiny Python script that accepts a class diagram description, hits the yUML website to create an image from it, and saves the image to disk, embedding the diagram "source code" in the PNG's <a href="http://www.w3.org/TR/PNG/#11iTXt">iTXt chunk</a>:</p>
<pre><code class="python">import urllib
import urllib2

import png

def add_yuml_to_png(yuml, in_stream, out_stream):
    signature = png.read_signature(in_stream)
    out_stream.write(signature)

    for chunk in png.all_chunks(in_stream):
        if chunk.chunk_type == 'IEND':
            break
        chunk.write(out_stream)

    itxt_chunk = png.iTXtChunk.create('yuml', yuml)
    itxt_chunk.write(out_stream)

    # write the IEND chunk
    chunk.write(out_stream)

def create(yuml, output_filename):
    baseUrl = 'http://yuml.me/diagram/scruffy/class/'
    url = baseUrl + urllib.quote(yuml)

    original_png = urllib2.urlopen(url)
    output_file = file(output_filename, 'wb')

    add_yuml_to_png(yuml, original_png, output_file)

    output_file.close()

if __name__ == '__main__':
    import sys
    sys.exit(create(*sys.argv[1:3]))
</code></pre>

<p>The <code>png</code> module is a very rudimentary PNG handling module that I wrote just for this script. There are ready-made Python PNG modules out there, but I thought they'd be too heavy to pull in for this, and that it'd be fun to write the PNG-handling code. It was.</p>
<p>Later on, when you want to adjust the diagram, we can the following command on the PNG:</p>
<pre>
read_yuml_from_png.py yuml_order_example.png
[Customer]+1-&gt;*[Order], [Order]++1-items&gt;*[LineItem], [Order]-0..1&gt;[PaymentMethod]
</pre>

<p>And here's read_yuml_from_png.py:</p>
<pre><code class="python">import png

def read(pngFilename):
    yuml = '&lt;&lt;no yuml found&gt;&gt;'
    pngFile = file(pngFilename, 'rb')
    png.read_signature(pngFile)
    for chunk in png.all_chunks(pngFile):
        if chunk.chunk_type == 'iTXt':
            chunk = png.iTXtChunk(chunk)
            if chunk.keyword == 'yuml':
                yuml = chunk.text
                break
    pngFile.close()
    return yuml

if __name__ == '__main__':
    import sys
    sys.exit(read(sys.argv[1]))
</code></pre>

<p>and out pops the original class diagram description.</p>
<p>The <strong>png</strong> module is kind of long to paste here, but you can get all of the source for this post from <a href="http://code.google.com/p/blairconrad/source/browse/#svn/trunk/BlogExamples/2010-05-yuml-embed-text%3Fstate%3Dclosed">my Google code project</a> (<a href="https://blairconrad.googlecode.com/svn/trunk/BlogExamples/2010-05-yuml-embed-text">direct link to source</a>).</p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Blair Conrad
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blairconrad.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blairconrad.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blairconrad.com/theme/js/respond.min.js"></script>




</body>
</html>